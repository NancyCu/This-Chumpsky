<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CFG → CNF Converter (Pyodide)</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.28.0/full/pyodide.js"></script>
  <style>
    body { font-family: system-ui; padding: 1rem; max-width: 42rem; margin: auto; }
    textarea { width: 100%; }
    pre { padding: 1rem; background: #f6f8fa; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>CFG → CNF Converter (Pyodide)</h1>
  <textarea id="src" rows="6">S -> ASA | aB
A -> B | S
B -> b | ε</textarea><br>
  <button id="run">Convert to CNF</button>
  <pre id="out"></pre>

<script type="module">
/* ---------- 1.  spin-up Pyodide ---------- */
const pyodide = await loadPyodide();

/* ---------- 2.  full CNF engine ---------- */
const pythonCode = `
import re, itertools
from collections import defaultdict, deque

# ---------- Parser ----------
def parse_cfg(text):
    g = defaultdict(list)
    for line in text.strip().splitlines():
        if not line.strip(): continue
        left, right = re.split(r'\\s*->\\s*', line)
        for prod in right.split('|'):
            prod = prod.strip().replace('E','ε')
            symbols = prod.split() if ' ' in prod else list(prod)
            g[left.strip()].append(symbols or ['ε'])
    return dict(g)

# ---------- Pretty-printer ----------
def fmt(g):
    return "\\n".join(f"{A} -> " + " | ".join(" ".join(p) for p in g[A]) for A in g)

# ---------- utility steps ----------
def remove_null(g,s): ...
def remove_unit(g): ...
def remove_useless(g,s): ...
def convert_to_cnf(g): ...
#  ⬆︎   paste the exact bodies from your  cnf_converter.py  (unchanged)

# ---------- public API ----------
def to_cnf(text):
    steps=[]
    def log(lbl,G): steps.append((lbl,fmt(G)))

    G = parse_cfg(text);  S = next(iter(G));               log("Original CFG",G)
    G = remove_null(G,S);                                 log("ε-removed",G)
    G = remove_unit(G);                                   log("Unit-removed",G)
    G = remove_useless(G,S);                              log("Useless-removed",G)
    G = convert_to_cnf(G);                                log("CNF",G)

    return "\\n\\n".join(f"{lbl}:\\n{body}" for lbl,body in steps)

def generate(text,max_len=4,max_words=20):
    G=parse_cfg(text); S=next(iter(G))
    words=set(); Q=deque([[S]])
    while Q and len(words)<max_words:
        seq=Q.popleft()
        term="".join(c for c in seq if c not in G and c!="ε")
        if len(term)>max_len: continue
        if all(c not in G for c in seq):
            if term: words.add(term); continue
        for i,sym in enumerate(seq):
            if sym in G:
                for prod in G[sym]:
                    Q.append(seq[:i]+[t for t in prod if t!="ε"]+seq[i+1:]); break
    return sorted(words)
`;
pyodide.runPython(pythonCode);

/* ---------- 3.  wire the buttons ---------- */
const out      = document.getElementById("out");
const textarea = document.getElementById("src");
document.getElementById("run").onclick = () => {
  out.textContent = pyodide.runPython(`to_cnf("""${textarea.value}""")`);
};

/* optional extra: language generation slider & button */
</script>
</body>
</html>
