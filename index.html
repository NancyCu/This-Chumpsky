<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CFG → CNF (Python in the Browser)</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.28.0/full/pyodide.js"></script>
  <style>
    body { font-family: system-ui; padding: 1rem; max-width: 42rem; margin: auto }
    textarea, pre { width: 100%; margin-top: 1rem; }
  </style>
</head>
<body>
  <h1>CFG → CNF Converter (Pyodide)</h1>

  <textarea id="src" rows="6">S -> ASA | aB
A -> B | S
B -> b | ε</textarea>
  <button id="run">Convert to CNF</button>
  <pre id="out" style="background:#f6f8fa;padding:1rem;"></pre>

  <script type="module">
    const pyodide = await loadPyodide();

    // Your real CNF converter goes here later — for now, just uppercase
const pythonCode = `
import re
from collections import defaultdict

def to_cnf(text):
    grammar = defaultdict(list)

    for line in text.strip().splitlines():
        if not line.strip(): continue
        left, right = re.split(r'\\s*->\\s*', line)
        for production in right.split('|'):
            prod = production.strip().replace('E', 'ε')
            symbols = prod.split() if ' ' in prod else list(prod)
            grammar[left.strip()].append(symbols)

    def format(g):
        return '\\n'.join(f"{nt} -> {' | '.join(''.join(p) for p in ps)}" for nt, ps in g.items())

    # Demo only — mock simplifier:
    return "Converted CNF (basic parser only):\\n" + format(grammar)
`;
    pyodide.runPython(pythonCode);

    document.getElementById("run").onclick = () => {
      const raw = document.getElementById("src").value;
      const result = pyodide.runPython(`to_cnf("""${raw}""")`);
      document.getElementById("out").textContent = result;
    };
  </script>
</body>
</html>
